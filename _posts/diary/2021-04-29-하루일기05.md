---
title: "하루 일기 (5)"
excerpt: "오늘 배운것 정리 2021-05-03 MES-APP을 보고 느낀점"
categories:
  - diary
tags:
  - jekyll
last_modified_at: 2018-07-01T13:00:00+09:00
toc: true
toc_sticky: true
---

## 1. style에 관해서 

### 1.1 Style은 객체화 한다.

> 길어질수 있는 style들은 객체화 해서 적용한다.

### 1.2 styled-component를 사용할때, 기본적으로 적용될것 같은것은 styled-component에 , 다른 style이 적용되어 바뀔수 있는것들은 inline으로 적용한다. 그 이유는 inline으로 적용된 style이 더 우선순위가 높기 때문이다.

```js

import React from 'react'
import styled from 'styled-components/native'

interface Props {
  children?: React.ReactElement
  style?: Record<string, unknown>
}

const FrequentlyContentBetweenView: React.FunctionComponent<Props> = ({ children, style }) => {
  return (
    <Container style={style}>
      {children}
    </Container>
  )
}

export default FrequentlyContentBetweenView

const Container = styled.div<any>(() => ({
    flexDirection: 'row',
    justifyContent: 'space-between'
  }))
  
```

> Container의 기본값은 row , space-between 이지만 , props에 의해서 언제든지 변할수 있다.
> 즉 default는 style 안에 변하는값은 props로 받아서 

## 2. 모듈화 

### 2.1 기본적인 dom의 모듈화는 그것들의 props를 사용하여 어떤 type으로 사용할지 , 어떤건 적용하고 적용하지 말지 정한다.

> TextInput의 props가 다 객체인것을 주목하자.

```js
import React, { useEffect } from 'react'
import { Image, InteractionManager, ReturnKeyTypeOptions, TextInput, View } from 'react-native'
import { PRIVATE_COLOR } from '../../common/style/commonStyles'

// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
import searchIcon from '../../../public/icons/serchIcon.png'
import { KeyboardType } from '../../types'
import regexUtil from '../../utils/regexUtil'

interface Props {
  keyword: string | undefined
  placeHolder?: string
  onChange?: (text: string, type?: string) => void
  onSearch?: () => void
  styles?: Record<string, unknown>
  inputStyle?: Record<string, unknown>
  editable?: boolean
  autoFocus?: boolean
  keyboardType?: KeyboardType
  type?: string
  placeholderTextColor?: string
  inputType?: string,
  multiline?: boolean,
  returnKeyType?: ReturnKeyTypeOptions
  maxLength?: number
  infiniteFocus?: boolean
  filter?: 'number' | 'ip' | 'double' | 'englishAndNumber'
  valueTextAlign?: 'center'
}

const rootInputStyle = {
  width: '100%',
  color: PRIVATE_COLOR.white,
  fontSize: 15,
  fontWeight: 'bold'
}


const FrequentlyInput: React.FunctionComponent<Props> = ({
                                                           keyword,
                                                           placeHolder,
                                                           inputStyle,
                                                           returnKeyType,
                                                           styles,
                                                           onSearch,
                                                           editable,
                                                           onChange,
                                                           autoFocus,
                                                           keyboardType,
                                                           type,
                                                           placeholderTextColor,
                                                           inputType,
                                                           multiline,
                                                           maxLength,
                                                           filter,
                                                           infiniteFocus,
                                                           valueTextAlign
                                                         }) => {
  const inputRef = React.useRef(null)
  const onSubmit = () => {
    onSearch && onSearch()
  }

  useEffect(() => {
    focusCallback()
  }, [ inputRef ])

  React.useEffect(() => {
    autoFocus && focusCallback()
  }, [ autoFocus ])

  const focusCallback = () => {
    InteractionManager.runAfterInteractions(() => {
      if (inputRef.current && autoFocus) {
        inputRef.current.focus()
      }
    })
  }

  const textFilter = (text) => {
    console.log(text, filter)
    switch (filter) {
      case 'number':
        text = text.toString().replace(regexUtil.ONLY_NUMBER_REGEX, '')
        text = text.length > 1 && text.startsWith('0') ? text.substring(1) : text
        break
      case 'ip':
        text = text.toString().replace(/[^0-9.]/g, '')
        break
      case 'double':
        const floatRegex = RegExp(regexUtil.FLOAT_NUMBER_REGEX)
        text = floatRegex.test(text) ? text : text.substring(0, text.length - 1)
        break
      case 'englishAndNumber':
        text = regexUtil.ENGLISH_AND_NUMBER_REGEX.test(text) ? text : keyword
        break
      default:
        break
    }

    const regex = RegExp(regexUtil.EMPTYSTRING_REGEX)
    !regex.test(text) && onChange && onChange(text, type ? type : undefined)
  }

  return (
    <View style={[ { justifyContent: 'flex-start', alignItems: 'center', flexDirection: 'row' }, styles ]}>
      {
        type === 'search' && <Image source={searchIcon} style={{ width: 24, height: 24 }}/>
      }
      <TextInput placeholder={placeHolder} style={[ rootInputStyle, inputStyle, { textAlign: valueTextAlign } ]}
                 onSubmitEditing={onSubmit}
                 value={keyword && keyword.toString()} ref={inputRef} keyboardType={keyboardType}
                 secureTextEntry={inputType === 'password'}
                 editable={editable} autoCapitalize="none"
                 placeholderTextColor={placeholderTextColor ? placeholderTextColor : 'rgba(255,255,255, .3)'}
                 onChangeText={(text: string) => textFilter(text)}
                 multiline={multiline} textAlignVertical={'top'}
                 returnKeyType={returnKeyType} maxLength={maxLength ? maxLength : 80}
      />
    </View>
  )
}

export default FrequentlyInput



```

## 2.2 내가 Customize 하는것들은 즉 modal과 같이 modal 하나로 다양한 모달을 만들기 위해서는 

> 어떤 조건에 따라 보여지는 View들을 바꿔준다. 

> 첫째, 일단 공통적인것들은 하나로 만들고 

> 나머지 조건에 의해서 바꿔지는 View들은 함수로 만들어서 어떤조건일때는 보여주고 아닐때는 없애는 식으로


```js

import React, { useEffect } from 'react'
import { Image, Text, TouchableOpacity, View } from 'react-native'
import Modal from 'react-native-modal'
import FrequentlyGradientView from './FrequentlyGradientView'
import styled from 'styled-components/native'
import FrequentlyLabel from './FrequentlyLabel'
import { PRIVATE_COLOR } from '../../common/style/commonStyles'
import FrequentlyContentBetweenView from './FrequentlyContentBetweenView'
import FrequentlyRowGradientView from './FrequentlyRowGradientView'
import FrequentlyModalInput from './FrequentlyModalInput'

// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
import rootListView from '../../../public/images/rootListView.png'
// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
import dangerIcon from '../../../public/icons/dangerIcon.png'
// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
import warningIcon from '../../../public/icons/warningIcon.png'
// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
import LockIcon from '../../../public/icons/lockIcon.png'

// @ts-ignore
import CheckWarningIcon from '../../../public/icons/checkWarning.png'
// @ts-ignore
import CheckSuccessIcon from '../../../public/icons/checkSuccess.png'
import {useDispatch, useSelector} from "react-redux";
import {RootState} from "../../modules";
import {modalInfoInitailize, modalInfoUpdateType} from "../../modules/modalInfo";


// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore

interface Props {
  isVisible: boolean
  message: string
  type: 'warning' | 'password' | 'passwordInput' | 'danger' | 'cancel' | 'delete' | 'logout' | 'confirm' | 'check_warning' | 'check_success' | ''
  onClose: (data?: any, message?: string) => void
  opacity?: number
  onCancel?: () => void
  user?: { name: string, profile: string, pk: string }
  mustPush?: boolean
  buttonTitle?: {
    confirm: string,
    cancel: string
  }
}

const Container = styled.View<any>(() => ({
  width: '100%',
  height: '100%',
  justifyContent: 'center',
  alignItems: 'center',
  borderBottomLeftRadius: 16,
  borderBottomRightRadius: 16
}))

const Content = styled.View<any>(() => ({
  width: 400.5,
  height: 408
}))

const ButtonView = styled.View<any>(() => ({
  width: '50%',
  height: 56
}))

const buttonGradientStyle = {
  width: '100%',
  height: '100%',
  flexDirection: 'row',
  justifyContent: 'center',
  alignItems: 'center'
}

const mainBetweenStyle = {
  flexDirection: 'column',
  height: '100%',
  alignItems: 'center'
}

const PasswordContainer = styled.ImageBackground(() => ({
  width: 333,
  height: 40
}))

const FrequentlyModal: React.FunctionComponent<Props> = ({
                                                           isVisible,
                                                           message,
                                                           type,
                                                           onClose,
                                                           opacity,
                                                           onCancel,
                                                           user,
                                                           mustPush,
                                                           buttonTitle
                                                         }) => {
  const [ password, setPassword ] = React.useState<string>('')
  const [ modalType, setModalType ] = React.useState<'warning' | 'password' | 'passwordInput' | 'danger' | 'cancel' | 'delete' | 'logout' | 'confirm' | 'check_warning' | 'check_success' | ''>(type)
  const [ modal, setModal ] = React.useState<boolean>(false)



  useEffect(() => {
    setModalType(type)
  }, [ type ])

  const onCloseCancel = () => {
    setModalType('cancel')
  }

  const onChangeText = (text: string) => {
    setPassword(text)
  }

  const inputPassword = () => {
    return (
      <PasswordContainer source={rootListView}>
        <FrequentlyRowGradientView styles={{
          width: '100%',
          height: '100%',
          flexDirection: 'row',
          justifyContent: 'space-between',
          paddingLeft: 10,
          borderRadius: 4
        }}>
          <TouchableOpacity style={{
            width: '100%',
            paddingRight: 16,
            alignItems: 'center',
            height: '100%',
            flexDirection: 'row',
            justifyContent: 'flex-start'
          }} onPress={() => setModal(true)}>
            <FrequentlyLabel text={password ? password.replace(/\w|\W/g, '*') : ''} textAlign={'left'}
                             color={'white'}
                             size={18}/>
          </TouchableOpacity>
        </FrequentlyRowGradientView>
        {
          modal &&
          <FrequentlyModalInput isVisible={modal}
                                type={'password'}
                                message={'비밀번호를 입력하세요.'} onClose={(keyword) => {
            onClose({ keyword: keyword })
            setModal(false)
            setPassword('')
          }} onChangeEvent={(keyword) => {
            onChangeText(keyword)
          }} onCancel={() => {
            setModal(false)
            setPassword('')
          }}/>
        }
      </PasswordContainer>
    )
  }


  const defaultColorFilter = React.useMemo(() => {
    if (type === 'danger') {
      return '#e63d43'
    } else if (type === 'check_warning') {
      return '#ff7200'
    } else if (type === 'check_success') {
      return '#00ff80'
    } else {
      return PRIVATE_COLOR.white
    }
  }, [ modalType ])

  const defaultIconFilter = React.useMemo(() => {
    if (modalType === 'danger') {
      return dangerIcon
    } else if (modalType === 'password') {
      return LockIcon
    } else if (modalType === 'check_warning') {
      return CheckWarningIcon
    } else if (modalType === 'check_success') {
      return CheckSuccessIcon
    } else {
      return warningIcon
    }
  }, [ modalType ])

  const defaultIconStyle = React.useMemo(() => {
    if (modalType === 'password') {
      return {
        width: 96, height: 136
      }
    } else if (modalType === 'check_warning' || modalType === 'check_success') {
      return {
        width: 139,
        height: 120.3
      }
    } else {
      return {
        width: 118,
        height: 120
      }
    }
  }, [ modalType ])

  const defaultFooterFilter = React.useMemo(() => {
    return (modalType !== 'check_warning' && modalType !== 'check_success')
  }, [ modalType ])

  const defaultView = () => (
    <FrequentlyContentBetweenView style={mainBetweenStyle}>
      <React.Fragment>
        <View>
          <View style={modalType === 'password' ? { marginTop: 32 } : { marginTop: 55 }}>
            <Image
              source={defaultIconFilter}
              style={defaultIconStyle}/>
          </View>
        </View>
        <FrequentlyLabel text={message} size={28} weight={'bold'} lineHeight={'50px'} textAlign={'center'}
                         color={defaultColorFilter} containerStyles={{ padding: 8 }}/>
        {
          modalType === 'password' && inputPassword()
        }
        {
          modalType === 'delete' &&
          <Text style={{ fontSize: 15, color: '#ff0009', fontWeight: '100' }}>
            * 삭제된 데이터는 복구되지 않습니다.
          </Text>
        }
        <View style={{ flexDirection: 'row' }}>
          {
            defaultFooterFilter && <ButtonView>
              <TouchableOpacity onPress={onCloseCancel}>
                <FrequentlyGradientView colors={[ 'rgba(166, 126, 240, .26)', 'rgba(99, 178, 175, .26)' ]}
                                        styles={[ buttonGradientStyle, { borderBottomLeftRadius: 16 } ]}>
                  <FrequentlyLabel text={buttonTitle && buttonTitle.cancel !== undefined ? buttonTitle.cancel : '취소'}
                                   size={18} weight={'bold'} color={PRIVATE_COLOR.white}/>
                </FrequentlyGradientView>
              </TouchableOpacity>
            </ButtonView>
          }
          <ButtonView style={{ width: defaultFooterFilter ? '50%' : '100%' }}>
            <TouchableOpacity onPress={() => {
              onClose({ keyword: password })
              //setPassword('')
            }}>
              <FrequentlyGradientView colors={[ 'rgba(0, 209, 255, 1)', 'rgba(104, 33, 255, 1)' ]}
                                      styles={[ buttonGradientStyle, {
                                        borderBottomRightRadius: 16,
                                        borderBottomLeftRadius: !defaultFooterFilter ? 16 : 0
                                      } ]}>
                <FrequentlyLabel text={buttonTitle && buttonTitle.confirm !== undefined ? buttonTitle.confirm : '확인'}
                                 size={18} weight={'bold'} color={PRIVATE_COLOR.white}/>
              </FrequentlyGradientView>
            </TouchableOpacity>
          </ButtonView>
        </View>
      </React.Fragment>
    </FrequentlyContentBetweenView>
  )

  const dispatch = useDispatch()
  const onCancelCallback = () => {
    if (onCancel) onCancel()
    dispatch(modalInfoInitailize())
    setPassword('')
    setModalType(type)
  }

  const cancelView = () => (
    <FrequentlyContentBetweenView style={mainBetweenStyle}>
      <React.Fragment>
        <View style={{ marginTop: 40, flexDirection: 'row', alignItems: 'center', height: '55%' }}>
          <FrequentlyLabel text={'취소 되었습니다.'} size={28} weight={'bold'}
                           textAlign={'center'}
                           color={PRIVATE_COLOR.white}/>
        </View>
        <View style={{ flexDirection: 'row' }}>
          <ButtonView style={{ width: '100%' }}>
            <TouchableOpacity onPress={onCancelCallback}>
              <FrequentlyGradientView colors={[ 'rgba(0, 209, 255, 1)', 'rgba(104, 33, 255, 1)' ]}
                                      styles={[ buttonGradientStyle, {
                                        borderBottomRightRadius: 16,
                                        borderBottomLeftRadius: 16
                                      } ]}>
                <FrequentlyLabel text={'확인'} size={18} weight={'bold'} color={PRIVATE_COLOR.white}/>
              </FrequentlyGradientView>
            </TouchableOpacity>
          </ButtonView>
        </View>
      </React.Fragment>
    </FrequentlyContentBetweenView>
  )


  return (
    <React.Fragment>    
      {
        isVisible && <View>
          <Modal isVisible={isVisible} onBackdropPress={() => !mustPush && onCancelCallback()}
                 backdropOpacity={opacity ? opacity : .9}
                 onBackButtonPress={() => !mustPush && onCancelCallback()}>
            <Container>
              {
                modalType === 'cancel'
                  ? <Content style={{ width: 400.33, height: '40%' }}>
                    <FrequentlyGradientView colors={[ 'rgba(166, 126, 240, .26)', 'rgba(99, 178, 175, .26)' ]}
                                            styles={{ height: '100%', borderRadius: 16 }}>
                      {cancelView()}
                    </FrequentlyGradientView>
                  </Content>
                  :
                  <Content style={{ width: 400.33 }}>
                    <FrequentlyGradientView
                      colors={[ 'rgba(166, 126, 240, .26)', 'rgba(99, 178, 175, .26)' ]}
                      styles={{ height: '100%', borderRadius: 16 }}>
                      {defaultView()}
                    </FrequentlyGradientView>
                  </Content>
              }
            </Container>
          </Modal>
        </View>
      }

    </React.Fragment>
  )
}

export default FrequentlyModal


```
