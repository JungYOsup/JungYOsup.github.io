---
title: "NEXT JS"
excerpt: "NEXT JS에 관해서"
categories:
  - next
tags:
  - jekyll
last_modified_at: 2018-07-01T13:00:00+09:00
toc: true
toc_sticky: true
---

## 1. SSR 에 대해서

### 1.1 SSR vs CSR

|             | CSR(Client Side Rendering)                                                                                                                                                                    | SSR(Server Side Rendering)                                                                                                  |
| ----------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------- |
| 대표적인 예 | React.js                                                                                                                                                                                      | Next.js                                                                                                                     |
| 장점        | 서버와 클라이언트 간의 데이터 양과 트래픽 현저히 감소 <br><br> 단 한번의 랜더링만 있으므로, 페이지 이동이 빠름 <br><br> 업데이트시 중복되는 화면은 그대로 두고 업데이트 되는 화면만 바뀜(SPA) | 초기 랜더링 속도가 빠름 <br><br> SEO 사용가능                                                                               |
| 단점        | SEO사용 불가 <br><br> 코드 Spliting으로 초기 랜더링이 느림                                                                                                                                    | 간단한 데이터 수정도 서버를 거쳐야함 <br><br> 연속적인 랜더링을 할 경우 서버 비용 증가 및 과부화로 서버가 터질수 있음테스트 |

### 1.2 SSR vs CCS Rendering 랜더링 차이점

|        | CSR(Client Side Rendering)                                                                                                                                                                                                                                                                                                                                           | SSR(Server Side Rendering)                                                                                                                                                                                                                                                                                                                                                                        |
| ------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 랜더링 | CSR은 SPA(Single Page Application)로, 클라이언트 사이드에서 HTML을 반환한 후에 JS가 동작하면서 데이터만을 주고 받아서 클라이언트에서 렌더링을 진행하는 것이다. <br><br>유저의 행동에 따라 필요한 부분만 다시 읽어들이기 때문에 SSR보다 빠른 인터랙션이 가능합니다. <br><br> 단, 페이지를 읽고 자바스크립트를 읽고나서 화면을 그리기 때문에 초기구동 속도가 느립니다. | SSR은 사용자가 웹페이지에 접근할 때, 서버에 각각의 페이지에 대한 요청을 하여 HTML,JS 등을 다시 다운로드 하여 화면에 렌더링하는 방식이다. <br><br>CSR과 비교하여 초기 구동속도가 빠르다는 장점이 있지만, 모든 요청에 관해 필요한 부분만 렌더링하는 것이 아니라 전체 페이지를 렌더링하기 때문에 불필요한 작업이 발생한다. <br><br> 그러나 Next.js에서는 REACT 프레임워크이기 때문에 SPA + SSR 이다. |

### 1.3 SSR 과 CSS의 랜더링 동작 방식

<img src="/assets/images/next_img/rendering.PNG" alt="랜더링"/>

### 1.3 왜? SSR이 검색엔진(SEO)에 최적화 일까?

> 네이버나, 구글이나, 다음 같은 곳에서 우리의 사이트를 검색했을때 우리의 사이트를 제대로 수집하기 위해서는 검색엔진에 최적화 되어야하는데, SSR이 검색엔진에 최적화라고 한다.
>
> 그 이유는 서버에서 클라이언트 대신 랜더링을 해주기 떄문이다.
>
> 클라이언트 대신 서버에서 랜더링 해주는게 왜 검색엔진에 최적화일까?
>
> 클라이언트에서 랜더링 하게 되면, 위에서 랜더링 방식에서 보듯이 빈 HTML을 반환후 -> JS 동작 -> 완성된 화면을 랜더링 하기 때문에 검색시 늦게 검색리스트에 뜰수 있다.
>
> 그러나 서버에서 랜더링을 하면, HTML을 다운로드 받고 바로 화면을 유저한테 바로 보여주기 때문에, 검색시 빠르게 검색리스트에 뜰수 있다.

### 1.4 SSR과 CSR로 본 REACT와 NEXT의 장 단점

![SSR VS CSR 그리고 NEXT]("https://medium.com/@msj9121/next-js-%EC%A0%9C%EB%8C%80%EB%A1%9C-%EC%95%8C%EA%B3%A0-%EC%93%B0%EC%9E%90-8727f76614c9")

### 1.5 그러면 언제 REACT를 사용하고 언제 NEXT를 사용할까?

> REACT는 컴퓨터 성능보다 떨어지는 모바일 앱 만들때 사용하는것을 추천한다.
>
> 자사에서만 사용할 홈페이지 만들때는 어차피 검색 될 필요가 많이 없으므로 REACT를 사용한다.
>
> 구글이나 네이버 , 다음에서 검색되어야할 것들은 NEXT로 제작해야한다.

## 2. Next.JS

### 2.1 Next.JS란

- Next. js 는 모든 페이지에 pre-rendering을 해준다.

* pre-rendering이란, 사전에 미리 HTML 파일을 만들어 놓음

- Next.js의 pre-rendering에는 **1. 정적생성**,**2.Server side rendering**이 있다.

* 이 둘의 차이점은 HTML 파일이 언제 생성되는가 이다.

### 2.2 Pre-rendering의 종류

- 1.정적생성 (static generation)

> 프로젝트가 빌드(코드가 소프트웨어가 되는)가 되는 시점에 html 파일들이 생성한다.
>
> 모든 요청에 재사용
>
> 정적 생성된 페이지들은 CDN(Contents delivery networ)에 캐시되고 나중에 또 요청할때 캐시에 저장된것을 재사용하게 함
>
> 데이터를 받을 때 getStaticProps / getStaticPaths 를 사용하며, 이것을 사용해서 데이터를 가져오는 경우, HTML에 데이터가 적용된 상태로 pre-rendering 됨

- 2.SSR (Server Side Rendering)

> 매 요청마다 html을 생성
>
> 그렇기에 항상 최산 상태 유지
>
> 데이터를 받을 때 getServerSideProps 를 사용하며, 이것을 사용해서 데이터를 가져오는 경우, HTML에 데이터가 적용된 상태로 pre-rendering 됨

### 2.3 정적생성 되어야할 페이지 또는 SSR 되어야할 페이지

### 2.4 Pre-rendering이 사용 여부

- Pre-rendring이 사용 되지 않는다면

> "빈화면 -> JS Load -> "페이지요소가 채워지고 사용자에게 보여짐"

- Pre-rendering이 사용 된다면

> "사전에 만들어진 HTML(메타데이터 포함)" -> JS Load -> "페이지요소가 채워지고 사용자에게 보여짐"

### 2.6 getStaticPaths

- 1.특징

> 지정된 것들을 정적생성(static generation) 할수 있다.
>
> 지정되자 않은것들 즉 나머지들은 처음에 빈화면 -> JS Load -> "페이지에 채워지고 사용자에게 보여짐" 이지만 이 이후에는 정적생성처럼 백그라운드에 HTML과 JSON을 생성한다. 그렇기에 새로고침시 기존에 있는것들을 재활용하기 떄문에 빠르게 나온다.

- 2.유용한점

> 특정인것들만 정적생성(static generation) 해줌으로써, 모든것들을 pre-rendering 해줬을 경우 걸리는 많은 빌드 시간을 줄일 수 있다.
>
> 따라서 최초의 접속자만 처음에 빈화면이 나오기 떄문에 불편할수 있지만 그 이후 접속자들은 재사용된것을 봄으로 느려지지 않는다.

- 3.사용방법

## 3. Link

> Link는 viewport에 있는 초기에 보여지는 화면 또는 스크롤시 viewport에 나타나는 것들을 prefetch한다
>
> prefetch란, 사전에 데이터들을 가져오는것을 의미한다.
>
> 여기서는 초기에 보여지는 화면 또는 스크롤시 html 과 json 파일을 미리 만들어 놓는다.
